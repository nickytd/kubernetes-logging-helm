{
   "index_patterns":[
      "containers-*"
   ],
   "mappings":{
      "_source":{
         "enabled":true
      },
      "dynamic_templates":[
         {
            "kubernetes.annotations.*/*":{
               "mapping":{
                  "type":"keyword"
               },
               "match_mapping_type":"*",
               "path_match":"kubernetes.annotations.*/*"
            }
         },          
         {
            "kubernetes.labels.*":{
               "mapping":{
                  "type":"keyword"
               },
               "match_mapping_type":"*",
               "path_match":"kubernetes.labels.*"
            }
         }         
      ],
      "properties":{
         "@timestamp":{
            "type":"date"
         },
         "location":{
            "type":"keyword"
         },         
         "log":{
            "type":"text"
         },
         "kubernetes":{
            "properties":{               
               "container_name":{
                  "type":"keyword",
                  "ignore_above":"256"
               },
               "container_image":{
                  "type":"keyword",
                  "ignore_above":"256"
               },
               "container_hash":{
                  "type":"keyword",
                  "ignore_above":"256"
               },
               "docker_id":{
                  "type":"keyword",
                  "ignore_above":"256"
               },
               "host":{
                  "type":"keyword",
                  "ignore_above":"256"
               },
               "namespace_name":{
                  "type":"keyword",
                  "ignore_above":"256"
               },
               "pod_id":{
                  "type":"keyword",
                  "ignore_above":"256"
               },
               "pod_name":{
                  "type":"keyword",
                  "ignore_above":"256"
               }               
            }
         }         
      }
   },
   "order":1,
   "settings":{
      "index":{
         "mapping":{
            "total_fields":{
               "limit":10000
            }
         },
         "max_docvalue_fields_search":200,
         "number_of_shards":"{{ (.Values.data.replicas | int) }}",
         "number_of_replicas":"{{ (sub (.Values.data.replicas | int) 1) }}",
         "query":{
            "default_field":[
               "log",
               "kubernetes.pod_name",
               "kubernetes.namespace_name",               
               "fields.*"
            ]
         },
         "refresh_interval":"5s"
      }
   }
}